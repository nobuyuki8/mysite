server {
listen 80;
listen [::]:80;

# ルートディレクトリとインデックスファイルの設定
root /var/www/html/public;
index index.php index.html;

# PHPファイルの処理（FPMへの転送）を先に定義する
# .phpで終わるリクエストのみを処理
location ~ \.php$ {
    # FastCGIパラメータをPHP-FPMコンテナに渡す
    fastcgi_pass app:9000;
    fastcgi_index index.php;
    
    # PHP-FPMが実行するスクリプトの絶対パスを明示
    fastcgi_param SCRIPT_FILENAME /var/www/html/public/$fastcgi_script_name;
    include fastcgi_params;
}

# Laravelのルーティング設定（静的ファイルとindex.phpへのフォールバック）
location / {
    # 該当ファイルがなければ /index.php にリクエストを渡す
    try_files $uri $uri/ /index.php?$query_string;
}

# MIMEタイプ関連の設定を追加
# ブラウザがファイルをダウンロードではなく表示するように促す
types {
    text/html                             html htm shtml;
    text/css                              css;
    application/javascript                js;
    # ... 他のMIMEタイプ定義
}


}